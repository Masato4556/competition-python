
自力で解けなかった。

AまたはBどちらかの純烈が昇順に並ぶようにソートすれば、最適解の１つになることに気づけるかが鍵だった。
数学的に証明できなくても、実験していたら気づけたかも

https://atcoder.jp/contests/arc149/editorial/4910