解説を見た限り、自分の考え方は大きく間違ってなさそう

全ての f(L,R)を列挙し辞書順にソートしたものの K 番目が、渡された順列 A より前か、後か、はたまた同じかの 3 つで分けて考えられる。
